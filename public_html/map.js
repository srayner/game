function Map() {

    this.loading = true;
    this.img = new Image();
    this.img.onload = function(){
        this.loading = false;
    };
    this.img.src = 'new.png';
    
    this.data = [
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,1,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,1,2,2,2,3,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,3,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,1,2,2,3,0,0,0,0,0,0,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0],
        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,12,12,0,0,0],
        [1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,12,12,12,2,2,3]
    ];
}

Map.prototype.draw = function(context) {
    
    // Blue background
    context.fillStyle = 'rgba(87, 139, 210, 1)';
    context.fillRect(0, 0, 768, 512);
    
    for (var y=0; y<16; y++) {
        for (var x=0; x<24; x++) {
            if (this.data[y][x] > 0) {
                var v = this.data[y][x] -1;
                var sx = (v % 10);
                var sy = (v-(v % 10))/10; 
                context.drawImage(this.img, sx * 41, sy * 41, 40, 40, 32 * x, 32 * y, 32, 32);
            }
        }
    }
   
};

Map.prototype.collision = function(x,y) {
    var collision = 0;
    for (var yMap=0; yMap<16; yMap++) {
        for (var xMap=0; xMap<24; xMap++) {
            if (this.data[yMap][xMap] > 0) {
                var mx = (xMap * 32) + 16;
                var my = (yMap * 32) + 16;
                var dx = Math.abs(x - mx);
                var dy = Math.abs(y - my);
                if ((dx < 32) && (dy < 32)) {
                    collision = this.data[yMap][xMap];
                }
            }
        }
    }
    return collision;
};